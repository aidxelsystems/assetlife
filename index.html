<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>資産寿命シミュレーション</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Outfit:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo">
                <i class="fa-solid fa-house-chimney-medical"></i>
                <span>見える化君</span>
            </div>
        </header>

        <!-- STEP 1: Input Form (Reordered) -->
        <section id="step-input" class="screen active">
            <div class="hero-text">
                <h1>あなたの資産、<br>何歳まで持ちますか？</h1>
                <p>5つの質問で老後の安心をシミュレーション</p>
            </div>

            <form id="simulation-form">
                <!-- 1. 年齢 -->
                <div class="form-group">
                    <label><i class="fa-solid fa-user"></i> ご年齢</label>
                    <select id="input-age" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="67">60代後半</option>
                        <option value="72">70代前半</option>
                        <option value="77">70代後半</option>
                        <option value="82">80代前半</option>
                        <option value="87">80代後半</option>
                        <option value="92">90歳以上</option>
                    </select>
                </div>

                <!-- 2. お体の状態 -->
                <div class="form-group">
                    <label><i class="fa-solid fa-heart-pulse"></i> お体の状態</label>
                    <select id="input-health" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="0">自立</option>
                        <option value="3000">歩行不安（リハビリ重視）</option>
                        <option value="6000">要支援</option>
                        <option value="20000">要介護1〜2</option>
                        <option value="30000">要介護3〜5</option>
                    </select>
                </div>

                <!-- 3. 月額年金受給額 -->
                <div class="form-group">
                    <label><i class="fa-solid fa-money-bill-wave"></i> 月額年金受給額</label>
                    <select id="input-pension" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="80000">10万円未満</option>
                        <option value="125000">10〜15万円</option>
                        <option value="175000">15〜20万円</option>
                        <option value="225000">20〜25万円</option>
                        <option value="275000">25〜30万円</option>
                        <option value="320000">30万円以上</option>
                    </select>
                </div>

                <!-- 4. 預貯金額 -->
                <div class="form-group">
                    <label><i class="fa-solid fa-piggy-bank"></i> 預貯金額</label>
                    <select id="input-savings" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="1500000">300万円未満</option>
                        <option value="4000000">300〜500万円</option>
                        <option value="7500000">500〜1,000万円</option>
                        <option value="15000000">1,000〜2,000万円</option>
                        <option value="25000000">2,000〜3,000万円</option>
                        <option value="40000000">3,000万円以上</option>
                    </select>
                </div>

                <!-- 5. 自宅査定額 -->
                <div class="form-group">
                    <label><i class="fa-solid fa-building"></i> ご自宅の査定額（目安）</label>
                    <select id="input-property" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="5000000">1,000万円未満</option>
                        <option value="15000000">1,000〜2,000万円</option>
                        <option value="30000000">2,000〜4,000万円</option>
                        <option value="50000000">4,000〜6,000万円</option>
                        <option value="70000000">6,000〜8,000万円</option>
                        <option value="90000000">8,000万円以上</option>
                        <option value="0">持ち家なし</option>
                    </select>
                </div>

                <button type="button" class="btn-primary" onclick="goToSimpleResult()">
                    シミュレーション結果を見る <i class="fa-solid fa-arrow-right"></i>
                </button>
            </form>
        </section>

        <!-- STEP 2: Simple Result -->
        <section id="step-simple-result" class="screen">
            <div class="result-header">
                <h2>簡易診断結果</h2>
                <div class="main-result">
                    <span class="label">資産寿命</span>
                    <div class="value"><span id="simple-age-result">--</span>歳<small>まで安心</small></div>
                </div>
            </div>

            <div class="chart-wrapper">
                <canvas id="simpleChart"></canvas>
            </div>

            <div class="message-box">
                <p><i class="fa-solid fa-triangle-exclamation"></i> <strong><span
                            id="simple-years-left">--</span>年後</strong>に資金が厳しくなる可能性があります。</p>
                <p class="sub-message">※85歳前後は医療・介護費が増えやすい時期です。</p>
            </div>

            <button type="button" class="btn-primary" onclick="goToBridge()">
                より正確な診断へ進む <i class="fa-solid fa-arrow-down"></i>
            </button>
        </section>

        <!-- STEP 3: Bridge (Address Input) -->
        <section id="step-bridge" class="screen">
            <div class="bridge-content">
                <i class="fa-solid fa-file-contract icon-large"></i>
                <h2>精密シミュレーションへ</h2>
                <p>正確な相場データを反映するために<br>以下の追加情報が必要です。</p>

                <form id="detail-form">
                    <div class="form-group">
                        <label>エリア（区）</label>
                        <select id="input-city">
                            <option value="港区">港区</option>
                            <option value="千代田区">千代田区</option>
                            <option value="世田谷区">世田谷区</option>
                            <option value="その他">その他</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>土地の広さ（坪）</label>
                        <select id="input-land-size">
                            <option value="less20">〜20坪</option>
                            <option value="20-30">20〜30坪</option>
                            <option value="30-40">30〜40坪</option>
                            <option value="more40">40坪〜</option>
                            <option value="unknown">不明</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>築年数</label>
                        <select id="input-building-age">
                            <option value="less15">15年未満</option>
                            <option value="15-25">15〜25年</option>
                            <option value="more25">25年以上</option>
                            <option value="unknown">不明</option>
                        </select>
                    </div>

                    <div style="margin: 24px 0; border-top: 1px dashed #ccc;"></div>

                    <div class="form-group">
                        <label>メールアドレス <span style="color:red">*</span></label>
                        <input type="email" id="input-email" placeholder="例：taro@example.com" required>
                    </div>

                    <div class="form-group">
                        <label>電話番号 <span style="font-size:0.8em; color:#999; font-weight:normal;">(任意)</span></label>
                        <input type="tel" id="input-phone" placeholder="例：090-1234-5678">
                    </div>

                    <p class="security-note"><i class="fa-solid fa-shield-halved"></i> この時点で業者に情報は送信されません</p>

                    <button type="button" class="btn-secondary" onclick="goToFullResult()">
                        あなたの条件で確認する <i class="fa-solid fa-lock"></i>
                    </button>
                    <p class="privacy-note"><small>入力情報はSSLで暗号化され保護されます。</small></p>
                </form>
            </div>
        </section>

        <!-- STEP 4: Full Result -->
        <section id="step-full-result" class="screen">
            <div class="result-header premium">
                <div class="badge">判断整理の結果</div>
                <div class="main-result">
                    <span class="label">修正後の資産寿命</span>
                    <div class="value"><span id="full-age-result">--</span>歳<small>まで伸長可能</small></div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="fullChart"></canvas>
            </div>

            <div class="warning-zone" id="warning-zone">
                <i class="fa-solid fa-circle-exclamation"></i>
                <p>資金ショートのリスクがある時期を確認してください。</p>
            </div>

            <!-- New Action Selection (A/B/C) -->
            <div class="action-selection">
                <h3>今後の進め方を選択</h3>

                <div class="option-card" onclick="selectAction('A')">
                    <div class="tag tag-a">A</div>
                    <div class="content">
                        <h4>早さと確実性を重視</h4>
                        <p>専門家と連携し、最短ルートで資金確保を進めます。</p>
                    </div>
                    <i class="fa-solid fa-chevron-right"></i>
                </div>

                <div class="option-card" onclick="selectAction('B')">
                    <div class="tag tag-b">B</div>
                    <div class="content">
                        <h4>条件を比較して高値を探す</h4>
                        <p>複数の選択肢から、最も有利な条件をじっくり比較します。</p>
                    </div>
                    <i class="fa-solid fa-chevron-right"></i>
                </div>

                <div class="option-card simple" onclick="selectAction('C')">
                    <div class="tag tag-c">C</div>
                    <div class="content">
                        <h4>まず一部だけ確認する</h4>
                        <p>まだ決めていない方向けの簡単な確認です。</p>
                    </div>
                    <i class="fa-solid fa-chevron-right"></i>
                </div>
            </div>
        </section>

        <!-- STEP 5: Final Confirm (A: Quick / B: Compare) -->
        <section id="step-final-confirm-ab" class="screen">
            <div class="confirm-header">
                <h2 id="final-confirm-title">最終確認</h2>
                <div class="info-note" style="text-align: left; margin-bottom: 20px;">
                    <p style="margin-bottom: 8px;"><strong>日程はまだ決める必要はありません。</strong><br>連絡しやすい条件だけお知らせください。</p>
                    <p style="font-size: 0.75rem; color: #888;">
                        ※以降の具体的なご連絡・日程調整は、担当業者より直接行われます。<br>本サービスは判断整理とご紹介までを行います。</p>
                </div>
            </div>

            <form id="form-confirm-ab">
                <!-- Checkboxes for Services (Pre-selected based on flow?) -->
                <!-- Assuming user selects services FIRST, then this screen appears? 
                     Actually, spec says "A-1 | Final Confirm ... Input items". 
                     It implies services were already selected or this screen asks for details FOR selected services.
                     Wait, spec A-2 says "Select Service" is saved. 
                     Let's keep the service selection checkboxes here as part of final confirmation. -->

                <p style="margin-bottom: 10px; font-weight: bold;">今回、どの実務を確認しますか？</p>
                <div class="checkbox-group" style="margin-bottom: 24px;">
                    <label class="checkbox-item">
                        <input type="checkbox" name="service" value="realestate">
                        <span class="custom-check"><i class="fa-solid fa-check"></i></span>
                        <div class="text"><strong>不動産</strong></div>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="service" value="nursing">
                        <span class="custom-check"><i class="fa-solid fa-check"></i></span>
                        <div class="text"><strong>老人ホーム</strong></div>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="service" value="buyback">
                        <span class="custom-check"><i class="fa-solid fa-check"></i></span>
                        <div class="text"><strong>出張買取</strong></div>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="service" value="car">
                        <span class="custom-check"><i class="fa-solid fa-check"></i></span>
                        <div class="text"><strong>車</strong></div>
                    </label>
                </div>

                <div style="margin: 24px 0; border-top: 1px dashed #ccc;"></div>

                <div class="form-group">
                    <label>① 希望連絡時間帯</label>
                    <select id="input-contact-time">
                        <option value="any">いつでも可</option>
                        <option value="weekday-am">平日 午前（9–12）</option>
                        <option value="weekday-pm">平日 午後（13–17）</option>
                        <option value="weekday-night">平日 夜（17–20）</option>
                        <option value="weekend">土日</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>② 急ぎ度 <span style="color:red; font-size:0.8em;">(重要)</span></label>
                    <select id="input-urgency">
                        <option value="soon">近いうちに相談したい</option>
                        <option value="week">1週間以内に動ければ十分</option>
                        <option value="year">1年以内に動きたい</option>
                        <option value="info">情報収集中（急いでいない）</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>詳細住所</label>
                    <p style="font-size: 0.85rem; color: #666; margin-bottom: 8px;">
                        <span id="prefilled-city" style="font-weight:bold;">--区</span> (入力済み)<br>
                        続きの番地・マンション名を入力してください
                    </p>
                    <input type="text" id="input-address-detail" placeholder="例：1-2-3 マンション◯◯ 101号室">
                </div>

                <div class="form-group">
                    <label>備考欄 <span style="font-size:0.8em; color:#999; font-weight:normal;">(任意)</span></label>
                    <textarea id="input-remarks" rows="3" placeholder="ご質問やご要望があればご記入ください"></textarea>
                </div>

                <p id="b-route-note" style="display:none; font-size:0.85rem; color:#d63031; margin-bottom:15px;">
                    ※ 比較のため複数社から連絡が入る場合があります
                </p>

                <button type="button" class="btn-primary" onclick="submitFinalAB()">
                    <span id="btn-text-ab">この内容でまとめて依頼する</span> <i class="fa-solid fa-paper-plane"></i>
                </button>
            </form>
            <button type="button" class="btn-text" onclick="showScreen('step-full-result')">戻る</button>
        </section>

        <!-- STEP 6: Final Confirm (C: Single Check) -->
        <section id="step-final-confirm-c" class="screen">
            <div class="confirm-header">
                <h2>まず一部だけ確認</h2>
                <div class="info-note">
                    <p><strong>※この確認は、比較や売却を前提としたものではありません。</strong><br>まだ動くか決めていない方向けの、負担のない「目安確認」です。</p>
                </div>
            </div>

            <form id="form-confirm-c">
                <p style="margin-bottom: 10px; font-weight: bold;">今回はどれを軽く確認しますか？</p>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="service_single" value="realestate">
                        <span class="custom-radio"></span>
                        <span class="label-text">不動産の査定を確認</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="service_single" value="nursing">
                        <span class="custom-radio"></span>
                        <span class="label-text">老人ホーム候補を確認</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="service_single" value="buyback">
                        <span class="custom-radio"></span>
                        <span class="label-text">出張買取を確認</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="service_single" value="car">
                        <span class="custom-radio"></span>
                        <span class="label-text">車の査定を確認</span>
                    </label>
                </div>

                <div style="margin: 24px 0; border-top: 1px dashed #ccc;"></div>

                <div class="form-group">
                    <label>詳細住所</label>
                    <p style="font-size: 0.85rem; color: #666; margin-bottom: 8px;">
                        <span id="prefilled-city-c" style="font-weight:bold;">--区</span> (入力済み)<br>
                        続きの番地・マンション名を入力してください
                    </p>
                    <input type="text" id="input-address-detail-c" placeholder="例：1-2-3 マンション◯◯ 101号室">
                </div>

                <div class="form-group">
                    <label>電話番号 <span style="font-size:0.8em; color:#999; font-weight:normal;">(任意)</span></label>
                    <p style="font-size: 0.75rem; color: #888; margin-bottom: 5px;">※具体的なご相談をご希望の場合のみ、別途ご連絡先をお伺いします。</p>
                    <input type="tel" id="input-phone-c" placeholder="例：090-1234-5678">
                </div>

                <div class="info-note" style="background:#fff3cd; color:#856404; margin-top:20px;">
                    <p style="font-weight:bold; font-size:0.8rem;">
                        以降の具体的なご連絡・日程調整は、<br>担当業者より直接行われます。<br>本サービスは判断整理とご紹介までを行います。</p>
                </div>

                <button type="button" class="btn-secondary" onclick="submitFinalC()">
                    この条件で確認する <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </form>
            <button type="button" class="btn-text" onclick="showScreen('step-full-result')">戻る</button>
        </section>

    </div>

    <script src="script.js"></script>
</body>

</html>
